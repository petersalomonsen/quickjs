const imageUrls = ['https://fictionspawnsite.files.wordpress.com/2022/05/bus-close-protocol.jpg',
'https://fictionspawnsite.files.wordpress.com/2022/04/another-cabin-save.jpg?w=2048',
'https://fictionspawnsite.files.wordpress.com/2022/05/swamp-sketch.jpg',
'https://fictionspawnsite.files.wordpress.com/2022/05/bus-inside.jpg?w=2048',
'https://fictionspawnsite.files.wordpress.com/2022/05/bus-steering-wheel-sketch.jpg?w=2048',
'https://fictionspawnsite.files.wordpress.com/2022/05/bunker-entrance-closed.jpg?w=2048',
'https://fictionspawnsite.files.wordpress.com/2022/05/bunker-entrance.jpg?w=2048',
'https://fictionspawnsite.files.wordpress.com/2022/05/hut-inside.jpg?w=2048',
'https://fictionspawnsite.files.wordpress.com/2022/05/open-box-close.jpg?w=1578',
'https://fictionspawnsite.files.wordpress.com/2022/05/open-box-rope.jpg?w=2048',
'https://fictionspawnsite.files.wordpress.com/2022/05/dead-man-close-sketch.jpg?w=2048'
];

const music = {"multiPatternSequence":[{"eventlistuncompressed":[{"time":20,"message":[145,60,67]},{"time":33,"message":[145,53,64]},{"time":46,"message":[145,34,51]},{"time":10660,"message":[129,53,0]},{"time":10680,"message":[145,64,54]},{"time":10686,"message":[145,26,65]},{"time":10686,"message":[129,34,0]},{"time":10693,"message":[145,57,78]},{"time":10700,"message":[129,60,0]},{"time":18653,"message":[145,67,47]},{"time":18666,"message":[145,60,67]},{"time":18667,"message":[129,64,0]},{"time":18680,"message":[145,29,57]},{"time":18686,"message":[129,26,0]},{"time":18773,"message":[129,57,0]},{"time":21293,"message":[129,60,0]},{"time":21293,"message":[129,29,0]},{"time":21300,"message":[129,67,0]}],"channel":1},{"eventlistuncompressed":[{"time":0,"message":[144,81,93]},{"time":0,"message":[144,22,88]},{"time":1666,"message":[144,93,79]},{"time":2606,"message":[128,93,0]},{"time":2666,"message":[144,86,82]},{"time":4333,"message":[144,88,83]},{"time":4413,"message":[128,86,0]},{"time":4753,"message":[128,81,0]},{"time":5333,"message":[144,81,83]},{"time":5446,"message":[128,88,0]},{"time":7000,"message":[144,93,79]},{"time":7953,"message":[128,93,0]},{"time":8000,"message":[144,86,83]},{"time":9666,"message":[144,88,83]},{"time":9760,"message":[128,86,0]},{"time":9800,"message":[128,81,0]},{"time":10593,"message":[128,22,0]},{"time":10666,"message":[144,81,84]},{"time":10666,"message":[144,29,67]},{"time":10673,"message":[128,88,0]},{"time":12333,"message":[144,93,79]},{"time":13320,"message":[128,93,0]},{"time":13333,"message":[144,86,83]},{"time":15000,"message":[144,88,72]},{"time":15086,"message":[128,86,0]},{"time":15906,"message":[128,81,0]},{"time":16000,"message":[144,81,87]},{"time":16047,"message":[128,88,0]},{"time":17666,"message":[144,93,75]},{"time":18599,"message":[128,93,0]},{"time":18666,"message":[144,86,79]},{"time":20333,"message":[144,88,82]},{"time":20419,"message":[128,86,0]},{"time":21253,"message":[128,88,0]},{"time":21293,"message":[128,29,0]},{"time":21293,"message":[128,81,0]}],"channel":0},{"eventlistuncompressed":[],"channel":2},{"eventlistuncompressed":[{"time":6907,"message":[150,81,53]},{"time":6994,"message":[134,81,0]},{"time":7020,"message":[150,84,78]},{"time":7147,"message":[150,86,68]},{"time":7160,"message":[134,84,0]},{"time":7313,"message":[150,88,74]},{"time":7320,"message":[134,86,0]},{"time":7613,"message":[134,88,0]},{"time":7720,"message":[150,88,54]},{"time":7746,"message":[150,89,68]},{"time":7747,"message":[134,88,0]},{"time":7913,"message":[134,89,0]},{"time":8067,"message":[150,91,39]},{"time":8094,"message":[134,91,0]},{"time":8100,"message":[150,89,54]},{"time":8147,"message":[150,91,23]},{"time":8180,"message":[134,89,0]},{"time":9060,"message":[150,89,39]},{"time":9067,"message":[134,91,0]},{"time":9153,"message":[134,89,0]},{"time":9160,"message":[150,91,92]},{"time":9227,"message":[134,91,0]},{"time":9246,"message":[150,89,75]},{"time":9333,"message":[150,88,74]},{"time":9333,"message":[134,89,0]},{"time":9800,"message":[134,88,0]},{"time":16333,"message":[150,81,62]},{"time":16413,"message":[134,81,0]},{"time":16447,"message":[150,84,78]},{"time":16540,"message":[134,84,0]},{"time":16547,"message":[150,86,64]},{"time":16860,"message":[134,86,0]},{"time":16933,"message":[150,88,44]},{"time":17133,"message":[134,88,0]},{"time":17333,"message":[150,89,49]},{"time":17593,"message":[134,89,0]},{"time":17653,"message":[150,91,72]},{"time":17813,"message":[134,91,0]},{"time":18000,"message":[150,91,70]},{"time":18020,"message":[150,92,73]},{"time":18073,"message":[134,91,0]},{"time":18073,"message":[134,92,0]},{"time":18086,"message":[150,93,83]},{"time":18986,"message":[134,93,0]},{"time":19007,"message":[150,91,67]},{"time":19080,"message":[134,91,0]},{"time":19087,"message":[150,93,75]},{"time":19154,"message":[134,93,0]},{"time":19173,"message":[150,91,87]},{"time":19273,"message":[134,91,0]},{"time":19280,"message":[150,89,65]},{"time":19953,"message":[134,89,0]},{"time":20007,"message":[150,84,83]},{"time":20674,"message":[134,84,0]}],"channel":6},{"eventlistuncompressed":[{"time":0,"message":[146,67,70]},{"time":0,"message":[146,73,100]},{"time":7,"message":[130,67,0]},{"time":67,"message":[130,73,0]},{"time":1000,"message":[146,73,50]},{"time":1133,"message":[130,73,0]},{"time":1334,"message":[146,73,100]},{"time":1467,"message":[130,73,0]},{"time":1667,"message":[146,67,100]},{"time":2000,"message":[146,73,80]},{"time":2067,"message":[130,73,0]},{"time":2334,"message":[130,67,0]}],"channel":2},{"eventlistuncompressed":[{"time":13,"message":[153,93,65]},{"time":33,"message":[153,82,66]},{"time":2613,"message":[153,91,70]},{"time":2620,"message":[153,88,70]},{"time":2640,"message":[137,93,0]},{"time":5273,"message":[153,89,70]},{"time":5286,"message":[137,91,0]},{"time":5293,"message":[153,86,64]},{"time":5293,"message":[137,88,0]},{"time":7946,"message":[153,88,70]},{"time":7953,"message":[137,89,0]},{"time":10573,"message":[137,88,0]},{"time":10600,"message":[137,82,0]},{"time":13267,"message":[153,88,70]},{"time":15986,"message":[153,89,62]},{"time":15994,"message":[137,88,0]},{"time":18600,"message":[153,91,60]},{"time":18646,"message":[137,89,0]},{"time":19980,"message":[137,86,0]},{"time":20053,"message":[153,88,50]},{"time":21273,"message":[137,91,0]},{"time":21273,"message":[137,88,0]}],"channel":9},{"eventlistuncompressed":[{"time":0,"message":[148,22,81]},{"time":347,"message":[132,22,0]},{"time":500,"message":[148,22,83]},{"time":787,"message":[132,22,0]},{"time":1000,"message":[148,22,77]},{"time":2320,"message":[132,22,0]},{"time":2333,"message":[148,29,65]},{"time":2353,"message":[132,29,0]},{"time":2500,"message":[148,34,63]},{"time":2620,"message":[132,34,0]},{"time":2667,"message":[148,22,89]},{"time":3007,"message":[132,22,0]},{"time":3167,"message":[148,22,71]},{"time":3480,"message":[132,22,0]},{"time":3667,"message":[148,22,78]},{"time":4907,"message":[132,22,0]},{"time":5000,"message":[148,21,88]},{"time":5133,"message":[132,21,0]},{"time":5333,"message":[148,22,91]},{"time":5673,"message":[132,22,0]},{"time":5833,"message":[148,22,77]},{"time":6060,"message":[132,22,0]},{"time":6333,"message":[148,22,64]},{"time":7520,"message":[132,22,0]},{"time":7667,"message":[148,29,62]},{"time":7694,"message":[132,29,0]},{"time":7833,"message":[148,34,78]},{"time":7946,"message":[132,34,0]},{"time":8000,"message":[148,22,81]},{"time":8347,"message":[132,22,0]},{"time":8500,"message":[148,22,78]},{"time":8727,"message":[132,22,0]},{"time":9000,"message":[148,24,79]},{"time":10467,"message":[132,24,0]},{"time":10667,"message":[148,26,87]},{"time":11007,"message":[132,26,0]},{"time":11167,"message":[148,26,72]},{"time":11320,"message":[132,26,0]},{"time":11667,"message":[148,26,69]},{"time":12954,"message":[132,26,0]},{"time":13000,"message":[148,33,62]},{"time":13107,"message":[132,33,0]},{"time":13167,"message":[148,36,67]},{"time":13254,"message":[132,36,0]},{"time":13333,"message":[148,26,87]},{"time":13633,"message":[132,26,0]},{"time":13833,"message":[148,26,65]},{"time":14066,"message":[132,26,0]},{"time":14333,"message":[148,26,69]},{"time":15580,"message":[132,26,0]},{"time":15667,"message":[148,24,72]},{"time":15740,"message":[132,24,0]},{"time":16000,"message":[148,26,80]},{"time":16307,"message":[132,26,0]},{"time":16500,"message":[148,26,80]},{"time":16667,"message":[132,26,0]},{"time":17000,"message":[148,26,68]},{"time":18333,"message":[148,33,64]},{"time":18407,"message":[132,26,0]},{"time":18480,"message":[132,33,0]},{"time":18500,"message":[148,36,69]},{"time":18587,"message":[132,36,0]},{"time":18667,"message":[148,26,77]},{"time":18980,"message":[132,26,0]},{"time":19167,"message":[148,26,65]},{"time":19547,"message":[132,26,0]},{"time":19667,"message":[148,29,78]},{"time":21254,"message":[132,29,0]}],"channel":4},{"eventlistuncompressed":[{"time":0,"message":[146,60,100]},{"time":333,"message":[146,66,30]},{"time":466,"message":[130,66,0]},{"time":667,"message":[130,60,0]},{"time":667,"message":[146,62,100]},{"time":1000,"message":[146,66,30]},{"time":1133,"message":[130,66,0]},{"time":1167,"message":[146,60,100]},{"time":1334,"message":[130,62,0]},{"time":1667,"message":[146,60,100]},{"time":1667,"message":[146,66,30]},{"time":1800,"message":[130,66,0]},{"time":1834,"message":[130,60,0]},{"time":2000,"message":[146,62,100]},{"time":2333,"message":[146,66,30]},{"time":2334,"message":[130,60,0]},{"time":2466,"message":[130,66,0]},{"time":2667,"message":[130,62,0]},{"time":2667,"message":[146,60,100]},{"time":3000,"message":[146,66,30]},{"time":3133,"message":[130,66,0]},{"time":3333,"message":[146,62,100]},{"time":3334,"message":[130,60,0]},{"time":3667,"message":[146,66,30]},{"time":3800,"message":[130,66,0]},{"time":4000,"message":[130,62,0]},{"time":4333,"message":[146,60,100]},{"time":4333,"message":[146,66,30]},{"time":4466,"message":[130,66,0]},{"time":4667,"message":[146,62,100]},{"time":5000,"message":[146,66,30]},{"time":5000,"message":[130,60,0]},{"time":5133,"message":[130,66,0]},{"time":5167,"message":[146,60,20]},{"time":5234,"message":[130,60,0]},{"time":5334,"message":[130,62,0]}],"channel":2},{"eventlistuncompressed":[{"time":0,"message":[148,31,87]},{"time":513,"message":[132,31,0]},{"time":666,"message":[148,38,83]},{"time":833,"message":[148,41,94]},{"time":866,"message":[132,38,0]},{"time":986,"message":[132,41,0]},{"time":1166,"message":[148,43,87]},{"time":1326,"message":[132,43,0]},{"time":1500,"message":[148,41,84]},{"time":1660,"message":[132,41,0]},{"time":1833,"message":[148,38,82]},{"time":1953,"message":[132,38,0]},{"time":1999,"message":[148,41,95]},{"time":2252,"message":[132,41,0]},{"time":2333,"message":[148,43,92]},{"time":2653,"message":[132,43,0]},{"time":2666,"message":[148,31,89]},{"time":3146,"message":[132,31,0]},{"time":3333,"message":[148,38,93]},{"time":3500,"message":[148,41,93]},{"time":3533,"message":[132,38,0]},{"time":3640,"message":[132,41,0]},{"time":3833,"message":[148,43,88]},{"time":3980,"message":[132,43,0]},{"time":4166,"message":[148,41,82]},{"time":4293,"message":[132,41,0]},{"time":4500,"message":[148,38,78]},{"time":4587,"message":[132,38,0]},{"time":4666,"message":[148,41,92]},{"time":4793,"message":[132,41,0]},{"time":4833,"message":[148,41,89]},{"time":4946,"message":[132,41,0]},{"time":5166,"message":[148,43,88]},{"time":5333,"message":[148,31,78]},{"time":5393,"message":[132,43,0]},{"time":5893,"message":[132,31,0]},{"time":6000,"message":[148,38,88]},{"time":6166,"message":[148,41,93]},{"time":6200,"message":[132,38,0]},{"time":6279,"message":[132,41,0]},{"time":6500,"message":[148,43,90]},{"time":6633,"message":[132,43,0]},{"time":6833,"message":[148,41,89]},{"time":6966,"message":[132,41,0]},{"time":7166,"message":[148,38,75]},{"time":7253,"message":[132,38,0]},{"time":7333,"message":[148,41,94]},{"time":7560,"message":[132,41,0]},{"time":7666,"message":[148,43,94]},{"time":7946,"message":[132,43,0]},{"time":8000,"message":[148,31,92]},{"time":8507,"message":[132,31,0]},{"time":8666,"message":[148,38,83]},{"time":8799,"message":[132,38,0]},{"time":8833,"message":[148,41,99]},{"time":8986,"message":[132,41,0]},{"time":9166,"message":[148,43,95]},{"time":9299,"message":[132,43,0]},{"time":9500,"message":[148,41,95]},{"time":9653,"message":[132,41,0]},{"time":9833,"message":[148,38,78]},{"time":9913,"message":[132,38,0]},{"time":10000,"message":[148,41,94]},{"time":10193,"message":[132,41,0]},{"time":10333,"message":[148,43,104]},{"time":10593,"message":[132,43,0]},{"time":10666,"message":[148,38,103]},{"time":11073,"message":[132,38,0]},{"time":11333,"message":[148,45,90]},{"time":11500,"message":[148,48,94]},{"time":11520,"message":[132,45,0]},{"time":11627,"message":[132,48,0]},{"time":11833,"message":[148,50,94]},{"time":11973,"message":[132,50,0]},{"time":12166,"message":[148,48,93]},{"time":12326,"message":[132,48,0]},{"time":12500,"message":[148,45,72]},{"time":12607,"message":[132,45,0]},{"time":12666,"message":[148,48,94]},{"time":12859,"message":[132,48,0]},{"time":13000,"message":[148,50,94]},{"time":13313,"message":[132,50,0]},{"time":13333,"message":[148,38,95]},{"time":13893,"message":[132,38,0]},{"time":14000,"message":[148,45,83]},{"time":14147,"message":[132,45,0]},{"time":14166,"message":[148,48,87]},{"time":14319,"message":[132,48,0]},{"time":14500,"message":[148,50,94]},{"time":14633,"message":[132,50,0]},{"time":14833,"message":[148,50,88]},{"time":14933,"message":[132,50,0]},{"time":15000,"message":[148,50,82]},{"time":15000,"message":[148,48,59]},{"time":15013,"message":[132,50,0]},{"time":15300,"message":[132,48,0]},{"time":15333,"message":[148,45,94]},{"time":15626,"message":[132,45,0]},{"time":15666,"message":[148,43,72]},{"time":15993,"message":[132,43,0]},{"time":16000,"message":[148,38,93]},{"time":16507,"message":[132,38,0]},{"time":16666,"message":[148,45,89]},{"time":16819,"message":[132,45,0]},{"time":16833,"message":[148,48,88]},{"time":16986,"message":[132,48,0]},{"time":17166,"message":[148,50,90]},{"time":17306,"message":[132,50,0]},{"time":17500,"message":[148,48,74]},{"time":17647,"message":[132,48,0]},{"time":17833,"message":[148,45,67]},{"time":17926,"message":[132,45,0]},{"time":18000,"message":[148,48,87]},{"time":18247,"message":[132,48,0]},{"time":18333,"message":[148,50,78]},{"time":18653,"message":[132,50,0]},{"time":18666,"message":[148,38,92]},{"time":19033,"message":[132,38,0]},{"time":19166,"message":[148,38,68]},{"time":19299,"message":[132,38,0]},{"time":19333,"message":[148,45,83]},{"time":19486,"message":[132,45,0]},{"time":19500,"message":[148,48,88]},{"time":19633,"message":[132,48,0]},{"time":19833,"message":[148,50,93]},{"time":19960,"message":[132,50,0]},{"time":20166,"message":[148,48,93]},{"time":20306,"message":[132,48,0]},{"time":20500,"message":[148,45,95]},{"time":20687,"message":[132,45,0]},{"time":20833,"message":[148,43,98]},{"time":21000,"message":[132,43,0]},{"time":21166,"message":[148,41,94]},{"time":21313,"message":[132,41,0]}],"channel":4},{"eventlistuncompressed":[{"time":0,"message":[179,64,0]},{"time":0,"message":[179,64,127]},{"time":0,"message":[147,57,94]},{"time":0,"message":[147,43,84]},{"time":333,"message":[147,58,66]},{"time":647,"message":[131,57,0]},{"time":666,"message":[147,65,89]},{"time":680,"message":[131,58,0]},{"time":1000,"message":[147,57,59]},{"time":1006,"message":[131,65,0]},{"time":1166,"message":[147,58,69]},{"time":1466,"message":[131,58,0]},{"time":1480,"message":[131,57,0]},{"time":1500,"message":[147,65,74]},{"time":1820,"message":[131,65,0]},{"time":1833,"message":[147,57,60]},{"time":1999,"message":[147,58,72]},{"time":2273,"message":[131,57,0]},{"time":2333,"message":[147,65,64]},{"time":2440,"message":[131,43,0]},{"time":2626,"message":[131,65,0]},{"time":2666,"message":[147,57,89]},{"time":2666,"message":[147,43,75]},{"time":2666,"message":[131,58,0]},{"time":2999,"message":[147,58,69]},{"time":3333,"message":[147,64,72]},{"time":3353,"message":[131,57,0]},{"time":3639,"message":[131,58,0]},{"time":3666,"message":[147,57,77]},{"time":3673,"message":[131,64,0]},{"time":3833,"message":[147,58,86]},{"time":4166,"message":[147,64,67]},{"time":4166,"message":[131,57,0]},{"time":4173,"message":[131,58,0]},{"time":4500,"message":[147,57,55]},{"time":4526,"message":[131,64,0]},{"time":4666,"message":[147,58,88]},{"time":4700,"message":[131,57,0]},{"time":5000,"message":[147,64,79]},{"time":5006,"message":[131,58,0]},{"time":5113,"message":[131,43,0]},{"time":5333,"message":[179,64,0]},{"time":5333,"message":[147,57,82]},{"time":5333,"message":[147,43,83]},{"time":5340,"message":[131,64,0]},{"time":5666,"message":[147,58,76]},{"time":5833,"message":[179,64,127]},{"time":5993,"message":[131,57,0]},{"time":6000,"message":[147,65,79]},{"time":6059,"message":[131,58,0]},{"time":6307,"message":[131,65,0]},{"time":6333,"message":[147,57,63]},{"time":6500,"message":[147,58,66]},{"time":6827,"message":[131,58,0]},{"time":6833,"message":[147,65,72]},{"time":6833,"message":[131,57,0]},{"time":7166,"message":[147,57,59]},{"time":7233,"message":[131,65,0]},{"time":7333,"message":[147,58,72]},{"time":7619,"message":[131,57,0]},{"time":7666,"message":[147,65,79]},{"time":7793,"message":[131,43,0]},{"time":7913,"message":[131,65,0]},{"time":7980,"message":[131,58,0]},{"time":8000,"message":[179,64,0]},{"time":8000,"message":[147,57,90]},{"time":8000,"message":[147,43,69]},{"time":8166,"message":[179,64,127]},{"time":8333,"message":[147,58,69]},{"time":8647,"message":[131,57,0]},{"time":8666,"message":[147,64,69]},{"time":8666,"message":[131,58,0]},{"time":9000,"message":[147,57,53]},{"time":9006,"message":[131,64,0]},{"time":9166,"message":[147,58,76]},{"time":9487,"message":[131,57,0]},{"time":9500,"message":[147,64,82]},{"time":9506,"message":[131,58,0]},{"time":9833,"message":[147,57,54]},{"time":9840,"message":[131,64,0]},{"time":10000,"message":[147,58,69]},{"time":10333,"message":[147,64,72]},{"time":10346,"message":[131,57,0]},{"time":10387,"message":[131,58,0]},{"time":10627,"message":[131,43,0]},{"time":10666,"message":[179,64,0]},{"time":10666,"message":[147,53,74]},{"time":10666,"message":[147,38,88]},{"time":10713,"message":[131,64,0]},{"time":10833,"message":[179,64,127]},{"time":11000,"message":[147,57,69]},{"time":11279,"message":[131,53,0]},{"time":11333,"message":[147,64,79]},{"time":11360,"message":[131,57,0]},{"time":11666,"message":[147,53,54]},{"time":11673,"message":[131,64,0]},{"time":11833,"message":[147,57,68]},{"time":12166,"message":[147,64,72]},{"time":12173,"message":[131,57,0]},{"time":12186,"message":[131,53,0]},{"time":12493,"message":[131,64,0]},{"time":12500,"message":[147,53,58]},{"time":12666,"message":[147,57,70]},{"time":12967,"message":[131,53,0]},{"time":13000,"message":[147,64,57]},{"time":13146,"message":[131,38,0]},{"time":13333,"message":[179,64,0]},{"time":13333,"message":[147,53,74]},{"time":13333,"message":[147,38,82]},{"time":13346,"message":[131,57,0]},{"time":13373,"message":[131,64,0]},{"time":13500,"message":[179,64,127]},{"time":13666,"message":[147,57,75]},{"time":13986,"message":[131,53,0]},{"time":14000,"message":[147,62,79]},{"time":14019,"message":[131,57,0]},{"time":14333,"message":[147,53,53]},{"time":14400,"message":[131,62,0]},{"time":14500,"message":[147,57,78]},{"time":14786,"message":[131,53,0]},{"time":14820,"message":[131,57,0]},{"time":14833,"message":[147,62,69]},{"time":15166,"message":[147,53,42]},{"time":15220,"message":[131,62,0]},{"time":15333,"message":[147,57,54]},{"time":15599,"message":[131,53,0]},{"time":15666,"message":[147,62,74]},{"time":15686,"message":[131,57,0]},{"time":15733,"message":[131,38,0]},{"time":16000,"message":[179,64,0]},{"time":16000,"message":[147,53,75]},{"time":16000,"message":[147,38,79]},{"time":16006,"message":[131,62,0]},{"time":16166,"message":[179,64,127]},{"time":16333,"message":[147,57,74]},{"time":16646,"message":[131,57,0]},{"time":16647,"message":[131,53,0]},{"time":16666,"message":[147,64,74]},{"time":16999,"message":[131,64,0]},{"time":17000,"message":[147,53,60]},{"time":17166,"message":[147,57,60]},{"time":17500,"message":[147,64,74]},{"time":17513,"message":[131,53,0]},{"time":17593,"message":[131,57,0]},{"time":17833,"message":[147,53,60]},{"time":17927,"message":[131,64,0]},{"time":18000,"message":[147,57,78]},{"time":18286,"message":[131,53,0]},{"time":18333,"message":[147,64,62]},{"time":18367,"message":[131,38,0]},{"time":18620,"message":[131,57,0]},{"time":18666,"message":[179,64,0]},{"time":18666,"message":[147,53,69]},{"time":18666,"message":[147,38,99]},{"time":18666,"message":[131,64,0]},{"time":18833,"message":[179,64,127]},{"time":19000,"message":[147,57,74]},{"time":19293,"message":[131,53,0]},{"time":19333,"message":[147,62,75]},{"time":19353,"message":[131,57,0]},{"time":19633,"message":[131,62,0]},{"time":19666,"message":[147,53,63]},{"time":19833,"message":[147,57,82]},{"time":19953,"message":[131,53,0]},{"time":20166,"message":[147,62,64]},{"time":20213,"message":[131,57,0]},{"time":20453,"message":[131,62,0]},{"time":20500,"message":[147,53,54]},{"time":20666,"message":[179,64,0]},{"time":20666,"message":[179,64,127]},{"time":20666,"message":[147,57,84]},{"time":21173,"message":[131,53,0]},{"time":21179,"message":[131,57,0]},{"time":21246,"message":[131,38,0]}],"channel":3},{"eventlistuncompressed":[{"time":3680,"message":[150,86,63]},{"time":3860,"message":[150,93,77]},{"time":3920,"message":[134,86,0]},{"time":3973,"message":[134,93,0]},{"time":4153,"message":[150,93,87]},{"time":4246,"message":[134,93,0]},{"time":4473,"message":[150,86,63]},{"time":4586,"message":[150,93,72]},{"time":4586,"message":[134,86,0]},{"time":4660,"message":[150,94,71]},{"time":4693,"message":[134,93,0]},{"time":4960,"message":[150,93,77]},{"time":5000,"message":[134,94,0]},{"time":5127,"message":[134,93,0]},{"time":5140,"message":[150,86,75]},{"time":5460,"message":[134,86,0]},{"time":8993,"message":[150,86,74]},{"time":9173,"message":[134,86,0]},{"time":9186,"message":[150,93,78]},{"time":9299,"message":[134,93,0]},{"time":9466,"message":[150,93,69]},{"time":9599,"message":[134,93,0]},{"time":9819,"message":[150,86,60]},{"time":9886,"message":[134,86,0]},{"time":9900,"message":[150,93,60]},{"time":9980,"message":[150,94,72]},{"time":10013,"message":[134,93,0]},{"time":10313,"message":[150,93,60]},{"time":10333,"message":[134,94,0]},{"time":10406,"message":[134,93,0]},{"time":10700,"message":[150,96,88]},{"time":11067,"message":[134,96,0]},{"time":11173,"message":[150,96,77]},{"time":11193,"message":[134,96,0]},{"time":11206,"message":[150,98,87]},{"time":11406,"message":[134,98,0]},{"time":11640,"message":[150,93,62]},{"time":12320,"message":[134,93,0]},{"time":13673,"message":[150,100,88]},{"time":13846,"message":[134,100,0]},{"time":13880,"message":[150,101,88]},{"time":13993,"message":[134,101,0]},{"time":14020,"message":[150,100,87]},{"time":14220,"message":[134,100,0]},{"time":14340,"message":[150,98,72]},{"time":14440,"message":[134,98,0]},{"time":14540,"message":[150,96,83]},{"time":14687,"message":[134,96,0]},{"time":14846,"message":[150,93,65]},{"time":14946,"message":[134,93,0]},{"time":15140,"message":[150,93,70]},{"time":15213,"message":[134,93,0]},{"time":15246,"message":[150,96,75]},{"time":15493,"message":[134,96,0]},{"time":15700,"message":[150,93,54]},{"time":15720,"message":[134,93,0]},{"time":16013,"message":[150,96,87]},{"time":16306,"message":[134,96,0]},{"time":16486,"message":[150,96,83]},{"time":16553,"message":[150,98,72]},{"time":16566,"message":[134,96,0]},{"time":16713,"message":[134,98,0]},{"time":16953,"message":[150,93,70]},{"time":17526,"message":[134,93,0]},{"time":18973,"message":[150,91,88]},{"time":19133,"message":[134,91,0]},{"time":19180,"message":[150,89,48]},{"time":19213,"message":[134,89,0]},{"time":19366,"message":[150,91,83]},{"time":19519,"message":[134,91,0]},{"time":19680,"message":[150,91,94]},{"time":19740,"message":[150,93,77]},{"time":19773,"message":[134,91,0]},{"time":19827,"message":[134,93,0]},{"time":20006,"message":[150,91,90]},{"time":20153,"message":[134,91,0]},{"time":20180,"message":[150,89,55]},{"time":20313,"message":[134,89,0]},{"time":20500,"message":[150,86,67]},{"time":20660,"message":[134,86,0]},{"time":20793,"message":[150,84,70]},{"time":21000,"message":[134,84,0]}],"channel":6},{"eventlistuncompressed":[{"time":0,"message":[146,73,100]},{"time":67,"message":[130,73,0]},{"time":333,"message":[146,73,20]},{"time":400,"message":[130,73,0]},{"time":666,"message":[146,73,100]},{"time":733,"message":[130,73,0]},{"time":1333,"message":[146,73,100]},{"time":1400,"message":[130,73,0]},{"time":1999,"message":[146,73,100]},{"time":2066,"message":[130,73,0]},{"time":2333,"message":[146,73,40]},{"time":2400,"message":[130,73,0]}],"channel":2}],"songParts":{"opening":{"startTime":0,"endTime":42666,"patterns":[{"patternIndex":0,"startTimes":[0,21333]},{"patternIndex":1,"startTimes":[0,21333]},{"patternIndex":2,"startTimes":[0,21333]},{"patternIndex":3,"startTimes":[21333]}]},"part1":{"startTime":42666,"endTime":85333,"patterns":[{"patternIndex":0,"startTimes":[42666,64000]},{"patternIndex":1,"startTimes":[42666,64000]},{"patternIndex":3,"startTimes":[64000]},{"patternIndex":4,"startTimes":[42666,45333,48000,50666,53333,56000,58666,61333,64000,66666,69333,72000,74666,77333,80000,82666]}]},"part2":{"startTime":85333,"endTime":128000,"patterns":[{"patternIndex":0,"startTimes":[85333,106666]},{"patternIndex":4,"startTimes":[85333,88000,90666,93333,96000,98666,101333,104000,106666,109333,112000,114666,117333,120000,122666,125333]},{"patternIndex":5,"startTimes":[85333,106666]},{"patternIndex":6,"startTimes":[85333,106666]},{"patternIndex":7,"startTimes":[85333,90666,96000,101333,106666,112000,117333,122666]}]},"part3":{"startTime":128000,"endTime":149333,"patterns":[{"patternIndex":5,"startTimes":[128000]},{"patternIndex":7,"startTimes":[128000,133333,138666,144000]},{"patternIndex":8,"startTimes":[128000]},{"patternIndex":9,"startTimes":[128000]},{"patternIndex":10,"startTimes":[128000]},{"patternIndex":11,"startTimes":[128000,130666,133333,136000,138666,141333,144000,146666]}]}}};

function signerAccountId() {
env.signer_account_id(0)
return env.read_register(0)
}

function argsJSON() {
env.jsvm_args(0);
const input = env.read_register(0);
return JSON.parse(input);
}

function readGameState(account_id) {
env.jsvm_storage_read(account_id, 1);

const gamestatejson = env.read_register(1);
if (gamestatejson) {
  return JSON.parse(gamestatejson);
} else {
  return null;
}
}
function writeGameState(game_state) {
const gameStateString = JSON.stringify(game_state);
env.jsvm_storage_write(signerAccountId(),
  gameStateString.padEnd(2048),
0);
}

export function newgame() {
const gamestate = imageUrls.map((val, ndx) => ({
  x: Math.floor(Math.random() * 3),
  y: Math.floor(Math.random() * 3),
  attempts: 0,
  keyFound: false
}));
writeGameState(gamestate);
}

export function view_game_state() {
const args = argsJSON();
const gamestate = readGameState(args.account_id);
if (gamestate) {
  const songpartvalues = Object.values(music.songParts);
  songpartvalues.forEach(part => {
    part.patterns.forEach(pattern => {
      pattern.eventlistuncompressed = music.multiPatternSequence[pattern.patternIndex].eventlistuncompressed;
    });
  });
  env.jsvm_value_return(JSON.stringify(gamestate.map((step, ndx, arr) => ({
    attempts: step.attempts,
    keyFound: step.keyFound,
    image: (step.keyFound || ndx == 0 || arr[ndx - 1].keyFound) ? imageUrls[ndx] : null,
    music: (step.keyFound || ndx == 0 || arr[ndx - 1].keyFound) ? songpartvalues[ndx] : null,
  }))));
}
}

/*
* example args: {"x": 1, "y": 1, "currentStep": 1}
*/
export function try_find_key() {
const args = argsJSON();

const gamestate = readGameState(signerAccountId());
const stateobj = gamestate.find(stateobj => !stateobj.keyFound);

if (!stateobj.keyFound) {
  stateobj.attempts++;

  if (stateobj.x == args.x && stateobj.y == args.y) {
    stateobj.keyFound = true;
  }
}
writeGameState(gamestate);
}
