var t="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var e={};var i={exports:e};(function(t,e){var s={};e(s);var r=s["default"];for(var h in s)r[h]=s[h];"object"===typeof i.exports?i.exports=r:t.sha256=r})(e,(function(e){e.__esModule=true;e.digestLength=32;e.blockSize=64;var i=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function hashBlocks(t,e,s,r,h){var n,a,f,o,u,p,d,l,v,c,g,b,y;while(h>=64){n=e[0];a=e[1];f=e[2];o=e[3];u=e[4];p=e[5];d=e[6];l=e[7];for(c=0;c<16;c++){g=r+4*c;t[c]=(255&s[g])<<24|(255&s[g+1])<<16|(255&s[g+2])<<8|255&s[g+3]}for(c=16;c<64;c++){v=t[c-2];b=(v>>>17|v<<32-17)^(v>>>19|v<<32-19)^v>>>10;v=t[c-15];y=(v>>>7|v<<32-7)^(v>>>18|v<<32-18)^v>>>3;t[c]=(b+t[c-7]|0)+(y+t[c-16]|0)}for(c=0;c<64;c++){b=(((u>>>6|u<<32-6)^(u>>>11|u<<32-11)^(u>>>25|u<<32-25))+(u&p^~u&d)|0)+(l+(i[c]+t[c]|0)|0)|0;y=((n>>>2|n<<32-2)^(n>>>13|n<<32-13)^(n>>>22|n<<32-22))+(n&a^n&f^a&f)|0;l=d;d=p;p=u;u=o+b|0;o=f;f=a;a=n;n=b+y|0}e[0]+=n;e[1]+=a;e[2]+=f;e[3]+=o;e[4]+=u;e[5]+=p;e[6]+=d;e[7]+=l;r+=64;h-=64}return r}var s=function(){function Hash(){(this||t).digestLength=e.digestLength;(this||t).blockSize=e.blockSize;(this||t).state=new Int32Array(8);(this||t).temp=new Int32Array(64);(this||t).buffer=new Uint8Array(128);(this||t).bufferLength=0;(this||t).bytesHashed=0;(this||t).finished=false;this.reset()}Hash.prototype.reset=function(){(this||t).state[0]=1779033703;(this||t).state[1]=3144134277;(this||t).state[2]=1013904242;(this||t).state[3]=2773480762;(this||t).state[4]=1359893119;(this||t).state[5]=2600822924;(this||t).state[6]=528734635;(this||t).state[7]=1541459225;(this||t).bufferLength=0;(this||t).bytesHashed=0;(this||t).finished=false;return this||t};Hash.prototype.clean=function(){for(var e=0;e<(this||t).buffer.length;e++)(this||t).buffer[e]=0;for(var e=0;e<(this||t).temp.length;e++)(this||t).temp[e]=0;this.reset()};Hash.prototype.update=function(e,i){void 0===i&&(i=e.length);if((this||t).finished)throw new Error("SHA256: can't update because hash was finished.");var s=0;(this||t).bytesHashed+=i;if((this||t).bufferLength>0){while((this||t).bufferLength<64&&i>0){(this||t).buffer[(this||t).bufferLength++]=e[s++];i--}if(64===(this||t).bufferLength){hashBlocks((this||t).temp,(this||t).state,(this||t).buffer,0,64);(this||t).bufferLength=0}}if(i>=64){s=hashBlocks((this||t).temp,(this||t).state,e,s,i);i%=64}while(i>0){(this||t).buffer[(this||t).bufferLength++]=e[s++];i--}return this||t};Hash.prototype.finish=function(e){if(!(this||t).finished){var i=(this||t).bytesHashed;var s=(this||t).bufferLength;var r=i/536870912|0;var h=i<<3;var n=i%64<56?64:128;(this||t).buffer[s]=128;for(var a=s+1;a<n-8;a++)(this||t).buffer[a]=0;(this||t).buffer[n-8]=r>>>24&255;(this||t).buffer[n-7]=r>>>16&255;(this||t).buffer[n-6]=r>>>8&255;(this||t).buffer[n-5]=r>>>0&255;(this||t).buffer[n-4]=h>>>24&255;(this||t).buffer[n-3]=h>>>16&255;(this||t).buffer[n-2]=h>>>8&255;(this||t).buffer[n-1]=h>>>0&255;hashBlocks((this||t).temp,(this||t).state,(this||t).buffer,0,n);(this||t).finished=true}for(var a=0;a<8;a++){e[4*a+0]=(this||t).state[a]>>>24&255;e[4*a+1]=(this||t).state[a]>>>16&255;e[4*a+2]=(this||t).state[a]>>>8&255;e[4*a+3]=(this||t).state[a]>>>0&255}return this||t};Hash.prototype.digest=function(){var e=new Uint8Array((this||t).digestLength);this.finish(e);return e};Hash.prototype._saveState=function(e){for(var i=0;i<(this||t).state.length;i++)e[i]=(this||t).state[i]};Hash.prototype._restoreState=function(e,i){for(var s=0;s<(this||t).state.length;s++)(this||t).state[s]=e[s];(this||t).bytesHashed=i;(this||t).finished=false;(this||t).bufferLength=0};return Hash}();e.Hash=s;var r=function(){function HMAC(e){(this||t).inner=new s;(this||t).outer=new s;(this||t).blockSize=(this||t).inner.blockSize;(this||t).digestLength=(this||t).inner.digestLength;var i=new Uint8Array((this||t).blockSize);if(e.length>(this||t).blockSize)(new s).update(e).finish(i).clean();else for(var r=0;r<e.length;r++)i[r]=e[r];for(var r=0;r<i.length;r++)i[r]^=54;(this||t).inner.update(i);for(var r=0;r<i.length;r++)i[r]^=54^92;(this||t).outer.update(i);(this||t).istate=new Uint32Array(8);(this||t).ostate=new Uint32Array(8);(this||t).inner._saveState((this||t).istate);(this||t).outer._saveState((this||t).ostate);for(var r=0;r<i.length;r++)i[r]=0}HMAC.prototype.reset=function(){(this||t).inner._restoreState((this||t).istate,(this||t).inner.blockSize);(this||t).outer._restoreState((this||t).ostate,(this||t).outer.blockSize);return this||t};HMAC.prototype.clean=function(){for(var e=0;e<(this||t).istate.length;e++)(this||t).ostate[e]=(this||t).istate[e]=0;(this||t).inner.clean();(this||t).outer.clean()};HMAC.prototype.update=function(e){(this||t).inner.update(e);return this||t};HMAC.prototype.finish=function(e){if((this||t).outer.finished)(this||t).outer.finish(e);else{(this||t).inner.finish(e);(this||t).outer.update(e,(this||t).digestLength).finish(e)}return this||t};HMAC.prototype.digest=function(){var e=new Uint8Array((this||t).digestLength);this.finish(e);return e};return HMAC}();e.HMAC=r;function hash(t){var e=(new s).update(t);var i=e.digest();e.clean();return i}e.hash=hash;e["default"]=hash;function hmac(t,e){var i=new r(t).update(e);var s=i.digest();i.clean();return s}e.hmac=hmac;function fillBuffer(t,e,i,s){var r=s[0];if(0===r)throw new Error("hkdf: cannot expand more");e.reset();r>1&&e.update(t);i&&e.update(i);e.update(s);e.finish(t);s[0]++}var h=new Uint8Array(e.digestLength);function hkdf(t,e,i,s){void 0===e&&(e=h);void 0===s&&(s=32);var n=new Uint8Array([1]);var a=hmac(e,t);var f=new r(a);var o=new Uint8Array(f.digestLength);var u=o.length;var p=new Uint8Array(s);for(var d=0;d<s;d++){if(u===o.length){fillBuffer(o,f,i,n);u=0}p[d]=o[u++]}f.clean();o.fill(0);n.fill(0);return p}e.hkdf=hkdf;function pbkdf2(t,e,i,s){var h=new r(t);var n=h.digestLength;var a=new Uint8Array(4);var f=new Uint8Array(n);var o=new Uint8Array(n);var u=new Uint8Array(s);for(var p=0;p*n<s;p++){var d=p+1;a[0]=d>>>24&255;a[1]=d>>>16&255;a[2]=d>>>8&255;a[3]=d>>>0&255;h.reset();h.update(e);h.update(a);h.finish(o);for(var l=0;l<n;l++)f[l]=o[l];for(var l=2;l<=i;l++){h.reset();h.update(o).finish(o);for(var v=0;v<n;v++)f[v]^=o[v]}for(var l=0;l<n&&p*n+l<s;l++)u[p*n+l]=f[l]}for(var p=0;p<n;p++)f[p]=o[p]=0;for(var p=0;p<4;p++)a[p]=0;h.clean();return u}e.pbkdf2=pbkdf2}));var s=i.exports;const r=i.exports.__esModule,h=i.exports.digestLength,n=i.exports.blockSize,a=i.exports.Hash,f=i.exports.HMAC,o=i.exports.hash,u=i.exports.hmac,p=i.exports.hkdf,d=i.exports.pbkdf2;export default s;export{f as HMAC,a as Hash,r as __esModule,n as blockSize,h as digestLength,o as hash,p as hkdf,u as hmac,d as pbkdf2};
